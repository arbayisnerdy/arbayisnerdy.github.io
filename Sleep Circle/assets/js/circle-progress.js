(function(c){function d(a){this.init(a)}d.prototype={value:0,size:100,startAngle:-Math.PI,thickness:"auto",fill:{gradient:["#3aeabb","#fdd250"]},emptyFill:"rgba(0, 0, 0, .1)",animation:{duration:1200,easing:"circleProgressEasing"},animationStartValue:0,reverse:false,lineCap:"butt",constructor:d,el:null,canvas:null,ctx:null,radius:0,arcFill:null,lastFrameValue:0,init:function(a){c.extend(this,a);this.radius=this.size/2;this.initWidget();this.initFill();this.draw()},initWidget:function(){var a=this.canvas=this.canvas||c("<canvas>").prependTo(this.el)[0];a.width=this.size;a.height=this.size;this.ctx=a.getContext("2d")},initFill:function(){var x=this,i=this.fill,b=this.ctx,z=this.size;if(!i){throw Error("The fill is not specified!")}if(i.color){this.arcFill=i.color}if(i.gradient){var s=i.gradient;if(s.length==1){this.arcFill=s[0]}else{if(s.length>1){var q=i.gradientAngle||0,r=i.gradientDirection||[z/2*(1-Math.cos(q)),z/2*(1+Math.sin(q)),z/2*(1+Math.cos(q)),z/2*(1-Math.sin(q))];var v=b.createLinearGradient.apply(b,r);for(var t=0;t<s.length;t++){var a=s[t],w=t/(s.length-1);if(c.isArray(a)){w=a[1];a=a[0]}v.addColorStop(w,a)}this.arcFill=v}}}if(i.image){var u;if(i.image instanceof Image){u=i.image}else{u=new Image();u.src=i.image}if(u.complete){y()}else{u.onload=y}}function y(){var e=c("<canvas>")[0];e.width=x.size;e.height=x.size;e.getContext("2d").drawImage(u,0,0,z,z);x.arcFill=x.ctx.createPattern(e,"no-repeat");x.drawFrame(x.lastFrameValue)}},draw:function(){if(this.animation){this.drawAnimated(this.value)}else{this.drawFrame(this.value)}},drawFrame:function(a){this.lastFrameValue=a;this.ctx.clearRect(0,0,this.size,this.size);this.drawEmptyArc(a);this.drawArc(a)},drawArc:function(j){var b=this.ctx,h=this.radius,i=this.getThickness(),a=this.startAngle;b.save();b.beginPath();if(!this.reverse){b.arc(h,h,h-i/2,a,a+Math.PI*2*j)}else{b.arc(h,h,h-i/2,a-Math.PI*2*j,a)}b.lineWidth=i;b.lineCap=this.lineCap;b.strokeStyle=this.arcFill;b.stroke();b.restore()},drawEmptyArc:function(j){var b=this.ctx,h=this.radius,i=this.getThickness(),a=this.startAngle;if(j<1){b.save();b.beginPath();if(j<=0){b.arc(h,h,h-i/2,0,Math.PI*2)}else{if(!this.reverse){b.arc(h,h,h-i/2,a+Math.PI*2*j,a)}else{b.arc(h,h,h-i/2,a,a-Math.PI*2*j)}}b.lineWidth=i;b.strokeStyle=this.emptyFill;b.stroke();b.restore()}},drawAnimated:function(f){var b=this,a=this.el;a.trigger("circle-animation-start");c(this.canvas).stop(true,true).css({animationProgress:0}).animate({animationProgress:1},c.extend({},this.animation,{step:function(e){var h=b.animationStartValue*(1-e)+f*e;b.drawFrame(h);a.trigger("circle-animation-progress",[e,h])},complete:function(){a.trigger("circle-animation-end")}}))},getThickness:function(){return c.isNumeric(this.thickness)?this.thickness:this.size/14}};c.circleProgress={defaults:d.prototype};c.easing.circleProgressEasing=function(l,k,a,b,j){if((k/=j/2)<1){return b/2*k*k*k+a}return b/2*((k-=2)*k*k+2)+a};c.fn.circleProgress=function(a){var f="circle-progress";if(a=="widget"){var b=this.data(f);return b&&b.canvas}return this.each(function(){var i=c(this),j=i.data(f),e=c.isPlainObject(a)?a:{};if(j){j.init(e)}else{e.el=i;j=new d(e);i.data(f,j)}})}})(jQuery);